!function(){function factory(ko,$,_){function _isMSDate(e){return"string"==typeof e&&e.match(/\/Date\(([0-9]+)(?:.*)\)\//)}function _parseDate(e){if(null===e||void 0===e||""==e)return null;if($.D.isDate(e))return e;switch(typeof e){case stringType:var r=e.match(/\/Date\(([0-9]+)(?:.*)\)\//),t=r?new Date(parseInt(r[1])):0/0;if(!isNaN(t))return t.addMinutes(t.getTimezoneOffset());var n=new Date(e);return isNaN(n)&&(n=$.D.parseISO8601Date(e)),isNaN(n)?alert("["+e+"] is not a date."):n;case numberType:return new Date(e)}return null}function parseFromServerDates(e){for(var r=0;r<e.length;r++)$.each(e[r],function(t,n){$.D.isDate(n)&&(e[r][t]=n.addMinutes(n.getTimezoneOffset()))});return e}function parseGuid(e){var r=/^([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})$/gi;return r.test(e)?e.replace(r,"guid'$1'"):null}function toAjaxDate(e){var r=new Date(e);return r.addMinutes(-r.getTimezoneOffset())}function odataFormatDate(e,r){return r||(e=toAjaxDate(e)),"datetime'"+ko.utils.stringifyJson(e).replace(/"/g,"")+"'"}function UserLayout(e){function r(){return $.parseJSON(localStorage.layout||"{}")}function t(e){return pageTitle+":"+e}$.fn.extend({LO:function(){var e=this.eq(0);return t(e.attr("lo")||e.prev().text().replace(/[^a-z0-9]/gi,"")+"Layout")},isVisible:function(){return"none"!==this.eq(0).css("display")}});var n=this;this.tags=r()||{},this.add=function(r){var t=$(r).LO();if(t){n.tags[t]={isVisible:$(r).isVisible()};var a=ko.utils.stringifyJson(n.tags);localStorage.layout=a,e&&e(t,n.tags)}},this.setLayout=function(e,r){var t=$(e),a=t.LO();if(a){var o=n.tags[a];o&&(o.isVisible?t.show():t.hide(),r&&r(e))}}}function ODataFilter(e,r,t){return this instanceof ODataFilter?(this.isGuid=!1,2==arguments.length&&$.isFunction(e)&&(t=e(r),e.isGuid&&(this.isGuid=e.isGuid()),r="eq",e=e()),this.field=e,this.operand=r,void(this.value=$.D.odataParam(t))):3==arguments.length?new ODataFilter(e,r,t):new ODataFilter(e,r)}function Guid(e){this.isGuid=!0,this.toString=function(){return e}}function UserSettingsBag(){function e(e){return pageTitle+":"+e}function r(){try{return $.parseJSON(localStorage.userSettings)}catch(e){return null}}function t(){localStorage.userSettings=ko.utils.stringifyJson(a)}var n=this,a=r()||{};_.isObject(a)||(a={}),this.get=_.wrap(function(e,r){return void 0===a[e]?r:a[e]},function(r,t,n){return r(e(t),n)}),this.set=_.wrap(function(e,r){return 1==arguments.length&&"string"!=typeof e?$.isArray(e)?$.each(e,function(e,r){n.set(r)}):$.each(e||{},function(e,r){n.set(e,r)}):(a[e]=r,t(),n["get_"+e]=function(){return a[e]}),n},function(r,t,a){if("string"==typeof t&&3==arguments.length)return r(e(t),a);if($.isPlainObject(t)&&2==arguments.length){var o=_.map(t,function(r,t){return[e(t),r]});return o.forEach(function(e){r.apply(n,e)}),n}if($.isArray(t)&&2==arguments.length)return t.forEach(function(t){if(!$.inArray(t)||2!=t.length)throw Error("UserSettingsBag: wrong arguments.");r(e(t[0]),t[1])}),n;throw Error("UserSettingsBag: wrong arguments.")})}function UUID(e){var r=e||"_",t=0;this.newId=function(e){return(e||r)+t++}}function Loader(e){function r(){$.each(o,function(e,r){n(r)})}function t(r,t){var i="function"==typeof __BASE_URL__&&__BASE_URL__()||"",s='<div id="divLoader" style="position:absolute;top:45%;left:45%;border-style:dotted;border-color:Gray;border-width:1px;padding:1px 10px;background-color:White;z-index:10000;cursor:pointer;display:none"><span></span><img src="'+i+'images/LoaderLongFadingLines.gif" style="vertical-align:middle" alt="Loading..." />';e||0!=$("#divLoader").length||(e=$(s).appendTo("BODY"));var u=$(e||"#divLoader").clone().appendTo(t||"BODY").center();return u.draggable().click(function(){n($(this))}),setTimeout(function(){u.animate({top:"+=100"},{duration:3e3,queue:!0})},0),o.push(u),u.find("SPAN").text(r),u.fadeIn("slow","swing"),u.destroy=function(e){return a.hide(this,e),a},u}function n(e,r){e&&(ko.utils.arrayRemoveItem(o,e),e.fadeOut(1500,"swing",function(){$(this).remove()}),r&&(r.fadingMessage&&$.D.fadingMessage(r.fadingMessage),r.successMessage&&$.D.successMessage(r.successMessage)))}var a=this,o=[];this.show=t,this.hide=n,this.hideAll=r}function loadParents(){var e={};this.push=function(r,t){return r+="",e[r]||(e[r]=[]),e[r].push(t),t},this.load=function(e,r){this.push(e+"",$(r)).D().loadTmpl(e+"")},this.shift=function(r){r+="";var t=$.D.prop(e,r);return t&&t.length?t.shift():alert("There is no load parent with name "+r)}}function JayData_init(e){function r(e){return e.hasOwnProperty("parent")&&e.hasOwnProperty("uid")&&e.hasOwnProperty("value")}function t(e,t){try{$.each(t.getFieldNames(),function(t,n){var a=e[this];a&&r(a)&&(e[this]=e[this].value)})}catch(n){$.D.fadingMessage(n+"")}}function n(e){return $.each(e.getFieldNames(),function(r,t){var n=e.field(t).memberDefinition;$data.Guid==n.dataType&&n.required&&(e.defaultValues[t]=n.defaultValue=function(){return $data.createGuid()})}),e}$.each(e.context,function(a,o){this instanceof $data.EntitySet&&(this[this.name].addEventListener("beforeUpdate",function(e,t,n){$.each(t.changedProperties,function(){var e=t[this.name];r(e)&&(t[this.name]=e.value)})}),this[this.name].addEventListener("beforeCreate",function(e,r,n){t(r,this)}),n(e[this.elementType.name]))})}function JayData$memberDefinition(e,r,t,n){return $.isArray(r)?void $.each(r,function(r,a){JayData$memberDefinition(e,this,t,n)}):(e instanceof $data.Queryable&&(e=e.defaultType),r=e.field?e.field(r):e.elementType.field(r),arguments.length<4?r.memberDefinition[t]:(r.memberDefinition[t]=n,r))}function sure_name(e,r,t){if(!e)throw new Error("Object is empty");if(1==arguments.length)return function(r){return 0==arguments.length?$.map(e,function(e,r){return r}):$.D.name(e,r)};if(r=r?r.toLowerCase():r)for(var n in e)if(n.toLowerCase()==r)return n;if(!t||!_.isBoolean(t))throw new Error("Property ["+r+"] not found in "+(JSON.prune?JSON.prune(e,1,10):JSON.stringify(e)));return!1}function CssRules(){function e(e,r){if(e=e.toLowerCase(),document.styleSheets)for(var t=0;t<document.styleSheets.length;t++){var n=document.styleSheets[t],a=0,o=!1;do{if(o=n.cssRules?n.cssRules[a]:(n.rules||[])[a],o&&o.selectorText.toLowerCase()==e)return"delete"==r?(n.cssRules?n.deleteRule(a):n.removeRule(a),!0):o;a++}while(o)}return!1}this.getCSSRule=e}function css_getclass(e,r){function t(){for(var e={},r=document.styleSheets,t=r.length,n=0;t>n;++n)for(var a=r[n].cssRules,o=(a||[]).length,i=0;o>i;++i)e[a[i].selectorText]=a[i];return e}if(!e)return null;var n=t();return e=sure_name(n,e),n[e]}function confirmedAction(e,r,t){var n=function(e,n,a,o){n?r():t&&t()};$.prompt(e,{buttons:{OK:!0,Cancel:!1},callback:n,submit:n})}function parseUtcDate(e){var r;try{if(r=Date.parse(e+"+0000"),isNaN(r))throw""}catch(t){try{r=Date.parse(e)}catch(t){return alert("["+e+"] is not supported format")}}return new Date(r)}function parseMetaUrl(e){if("string"!=typeof e)return{label:e,href:""};var r=(e||"").match(/\{(.+?)?\}(.*)/),t=r&&r[1]||e,n=r&&r[2]||r&&r[1]||e;return{label:t,href:n}}function xmlDocument(e){function r(e,r){var t=n.createElement(e);r.forEach(function(e){$(t).attr(e.name,e.value)}),n.documentElement.appendChild(t)}function t(){return(new XMLSerializer).serializeToString(n)}var n=$.parseXML("<"+e+"/>");return{doc:n,addXmlNode:r,toString:t}}function JayData$fetchLookUp(e,r,t){function n(e,r){return e.length=0,e.push.apply(e,r),e}return e.toArray(function(e){var a=r;n(a,JayData$lookUpMap(e,t))}).fail(function(e,r){$.D.makeErrorDialog(e)})}function JayData$lookUpMap(e,r,t,n){var a={text:"Select ...",value:"",isLookUp:!0},o="text",i="value";t&&(i=r,o=t,r=null);var s=$.map(e,function(e){return $.extend(r?r(e):{text:($.D.sure(e,o)||"").replace(/#/g,"\\#"),value:(($.D.sure(e,i)||"")+"").replace(/#/g,"\\#")},{isLookUp:!0})});return n!==!1&&(s=_.sortBy(s,function(e){return e.text.toUpperCase()})),[a].concat(s)}function sum(e){var r=function(r){return sum(e+r)};return r.valueOf=r.toString=function(){return e},r}function findAllValues(e,r){return _.has(e,r)?[e]:_.flatten(_.map(e,function(e){return"object"==typeof e?findAllValues(e,r):[]}),!0)}var stringType="string",numberType="number",urlParams;!function(){var e,r=/\+/g,t=/([^&=]+)=?([^&]*)/g,n=function(e){return decodeURIComponent(e.replace(r," "))},a=window.location.search.substring(1);for(urlParams={};e=t.exec(a);)urlParams[n(e[1])]=n(e[2])}(),ODataFilter.prototype.toString=function(){return this.field+" "+this.operand+" "+(this.isGuid?"guid":"")+this.value};var pageTitle=$("html head").find("title").text();$.extend(!0,{D:{}});var D={xmlDocument:xmlDocument,parseMetaUrl:parseMetaUrl,urlParams:function(e,r){if(0===arguments.length)return urlParams;r=r||{},$.isPlainObject(r)||(r={"default":r}),e=sure_name(urlParams,e,!0);var t=(e?urlParams[e]:r["default"])||r["default"];return t&&r.isDate?parseUtcDate(t):t},parseUtcDate:parseUtcDate,confirmedAction:confirmedAction,UserLayout:UserLayout,getCss:(new CssRules).getCSSRule,toWords:function(e){return e.split("__")[0].match(/[A-Z]+[a-z0-9]*/g).join(" ")},toPascalCase:function(e){return e.replace(/(\w)(\w*)/g,function(e,r,t){return r.toUpperCase()+t.toLowerCase()})},format_M_yy:function(e){return e.format("M").substr(0,1)+e.format("-y")},exportToExcel:function(e){var r=$("HTML").find("LINK"),t=r.map(function(){var e=$(this).attr("href"),r=$.ajax(e,{async:!1,dataType:"html"});return r.responseText}).toArray();return e="<HTML><head><style>"+t.join("\n")+"</style></head><body>"+e+"</body></html>",$.ajax({type:"POST",async:!1,dataType:"json",processData:!0,url:KPI.odataUrl+"GetHtmlAsExcel",data:{html:escape(e)},success:function(e){open(KPI.odataUrl+"GetHtml?cacheKey='"+e.d.GetHtmlAsExcel+"'&extention='htm'","_blank")},error:function(e,r,t){alert("exportToExcel:\n"+r)}})},fromODataDate:function(e){return new Date(e).addMinutes(e.getTimezoneOffset())},userSettings:new UserSettingsBag,Guid:Guid,isJQueryObject:function(e){return e.jquery&&!0},makeTemplateAccessor:function(e){var r=e.split("."),t=window;KPI.templates[e]=function(){return e},$.each(r,function(n,a){var o={};o[a]=n==r.length-1?function(){var r=function(){return e};return r.toString=function(){return e},r.url=e,r}():{},$.extend(!0,t,o),t=t[a]})},Math:{linearRegression:function(e,r){var t=0,n=0,a=0,o=0,i=0,s=0,u=0,c=e.length;if(c!=r.length)throw new Error("The parameters values_x and values_y need to have same size!");if(0===c)return[[],[]];for(var l=0;c>l;l++)s=e[l],u=r[l],t+=s,n+=u,o+=s*s,a+=s*u,i++;for(var f=(i*a-t*n)/(i*o-t*t),d=n/i-f*t/i,p=[],g=[],l=0;c>l;l++)s=e[l],u=s*f+d,p.push(s),g.push(u);return[p,g]}},toAbsURL:function(e){var r,t,n,a,o=location;if(/^\w+:/.test(e))return e;if(r=o.protocol+"//"+o.host+(""!=o.port?":"+o.port:""),0==e.indexOf("/"))return r+e;if(t=o.pathname.replace(/\/[^\/]*$/,""),n=e.match(/\.\.\//g))for(e=e.substring(3*n.length),a=n.length;a--;)t=t.substring(0,t.lastIndexOf("/"));return r+t+"/"+e},uuid:new UUID,loadParents:new loadParents,distinct:function(e,r){var t=[];return $.each(e,function(e,n){0===$.grep(t,function(e){return r(n,e)}).length&&t.push(n)}),t},insertItems:function(e,r,t){t=t||0;var n=[t,0].concat(r);e.splice.apply(e,n)},parseJsonError:function(e){var r=$.parseJSON((e.xhr||{}).message||(e.xhr||e).responseText).error;r||alert("Error!");var t=[r.message.value];if(r=r.innererror)for(t.push(r.message);r&&r.internalexception;)t.push(r.internalexception.message),r=r.internalexception;return t},showJsonError:function(e){alert($.D.parseJsonError(e).join("\n"))},serverExceptions:function(){var e={};return{register:function(r){var t={};t[r]=r,$.extend(!0,e,t)},isRegistered:function(r){return e.hasOwnProperty(r)}}}(),oData:{parseFromServerDates:parseFromServerDates,Filter:ODataFilter,requestObject:function(e,r,t){return{requestUri:e,method:t||"POST",data:r}},mergeRequestObject:function(e,r){return{requestUri:e,data:r,method:"POST",headers:{"X-HTTP-Method":"MERGE"}}},deleteRequestObject:function(e){return{requestUri:e,data:{},method:"DELETE"}},updateByFilter:function(e,r,t,n,a,o){var i=e.baseUrl||KPI.odataUrl;OData.read(i+e()+"?$filter="+r,function(s){if(s.results.length>1)return $.D.fadingMessage("Filter ["+r+"] must resolve to a single element.",5e3);if(s.results.length>0){var u=s.results[0].__metadata.uri||i+e(s.results[0].Id);OData.request($.D.oData.mergeRequestObject(u,t),function(e){a&&a(),$.D.successMessage("Update: Success.")})}else OData.request($.D.oData.requestObject(i+e(),n,"POST"),function(e){o?o(e):$.D.successMessage("Insert Success.")})})},deleteByFilter:function(e,r,t,n){OData.read(e+r()+"?$filter="+t,function(a){if(a.results.length>1)return $.D.fadingMessage("Filter ["+t+"] must resolve to a single element.",5e3);if(a.results.length>0){var o=$.D.prop(a.results[0],"ID"),i=void 0===o?a.results[0].__metadata.uri:e+r(o);OData.request($.D.oData.deleteRequestObject(i),function(e){(n||$.noop)(),$.D.successMessage("Delete: Success.")})}else alert("Entity "+r()+" where "+t+" not found.")})}},parseDate:_parseDate,isMSDate:_isMSDate,array:{splice:function(e,r){for(var t=[];e.length;)t.push(e.splice(0,r));return t},slice:function(e,r){for(var t=[],n=0;n<bigarray.length;n+=size)t.push(e.slice(n,n+r));return t}},objectName:function(e){return/function\s+(.+)\(/.exec(e.constructor+"")[1]},Loader:Loader,loader:new Loader,useDialog:function(e,r,t){2==arguments.length?e.dialog.bind(e)(r):e.dialog.bind(e)(r,t)},dialogOptions:function(e){return $.extend(!0,{autoOpen:!0,resizable:!0,width:"auto",minHeight:55,close:function(r,t){(e||{}).close&&e.close(),$(this).parents("DIV:last").remove()}},e)},fadingMessage:function(e,r,t,n){var a="#F778A1";if($.isPlainObject(r)){var o=r;r=o.fadingTime,a=o.bgColor||a}n&&n.dialog("close");var i={dialogClass:"noTitle",resizable:!1,minHeight:10,autoOpen:!1},s=$("<DIV class='fadingmessage'></DIV>").html(e).dialog($.D.dialogOptions($.extend(i,t)));s.dialog("widget").css("visibility","hidden"),s.dialog("open"),s.dialog("widget").css("visibility","visible");var u=_.once(s.dialog.bind(s,"destroy"));return r!==!1&&0!==r&&(s.dialog("widget").animate({top:"-=100"},r||5e3,function(){$(this).delay(1e3).fadeTo("slow",.25,"swing",u)}),s.animate({backgroundColor:a,color:"#FFFFFF"},(r||5e3)/10)),s.dialog("widget").click(u),s},successMessage:function(e,r,t,n){this.fadingMessage(e,{fadingTime:r,bgColor:"#79CF51"},t,n)},makeDialog:function(e,r){var t=$("<DIV></DIV>").html(e).dialog($.D.dialogOptions(r)),n=t.dialog.bind(t,"option"),a=_.debounce(function(){try{n("autoReposition")&&n("position",n("position"))}catch(e){}},500);return t.removeResize&&t.resize(a).on("dialogclose",function(){t.removeResize(a)}),t},makeErrorDialog:function(e,r){return $.D.makeDialog("<PRE>"+$.D.oDataErrorToString(e)+"</PRE>",r)},showDialog:function(e,r){e.html(r),e.dialog("isOpen")||(e.dialog("open"),e.dialog("option","position","center"))},oDataErrorToString:function(error){function _parseJson(e){if(0==(e+"").replace(/^\s+|\s+$/g,"").indexOf("{"))try{return $.parseJSON(e)}catch(r){try{return $.parseJSON(e.replace(/\{\s+"d"\s+:\s{\s+"results":\s+\[\s+\{/,""))}catch(r){return null}}return null}function _cleanException(e){return e.replace(/\\r\\n/g,"\n").replace(/",\s"/g,'",\n').replace(/The transaction ended in the trigger. The batch has been aborted./g,"").replace(/An error occurred while processing this request.\n/g,"").replace(/An error occurred while executing the command definition. See the inner exception for details.\n/g,"")}function _pumpMessages(e){message.push(e.message.value);var r=e.innererror;if(r){message.push(r.message);for(var t=r.internalexception;t;t=t.internalexception)message.push(t.message)}}var html=$(eval("error.data[0].response.body")).filter(function(){return["FONT"].indexOf($(this).prop("nodeName"))>=0}).text().replace(/\n{2,}/g,"\n");if(html)return html;var jsonError=error.responseJSON?JSON.stringify(error.responseJSON,null,2):null;if(jsonError)return jsonError.replace(/\\r\\n/g,"\n");if("string"==typeof error)return error;var isJayDataError=((error[0]||{}||{}).item||{})._entityState;if(isJayDataError)return $.map(error[0].errors,function(e){return e.Message+"\n"+e.PropertyDefinition.name+" is "+e.Type}).join("\n");var jsonError=null;if(error.responseText&&(jsonError=_parseJson(error.responseText),!jsonError))return error.responseText;if("undefined"!=typeof TypeError&&error instanceof TypeError)return error+"";if("undefined"!=typeof Exception&&error instanceof Exception){if(!error.data||$.isArray(error.data)&&0==error.data.length)return error.message;error=error.data[0]||error.data}try{if($.isArray(error.xhr)){try{var errClient=error.xhr[0].errors[0]}catch(e){}if("ValidationError"==$.D.objectName(errClient)){var oError={};return oError[errClient.Message]=errClient.PropertyDefinition,[ko.utils.stringifyJson(oError).replace(":",":\n")]}}var message=[$.D.propDeep(error,"requestUri")];if(message.push($.D.propDeep(error,"statusText")),jsonError)_pumpMessages(jsonError.error);else{var responseBody=$.D.deepPath(error,"response.body");if(jsonError=(_parseJson(responseBody)||{})["odata.error"])_pumpMessages(jsonError);else{try{var body,responseBody=$.D.propDeep(error.response||error,"body");if(responseBody)body=_parseJson(responseBody)||responseBody;else{var errorJson=_parseJson($.D.propDeep(error,"message"));body=errorJson}if(body){var innerError=(body.error||{}).innerError||body.error,type=$.Linq.last((((innerError||{}).innererror||{}).type||"").split("."));return type&&$.D.serverExceptions.isRegistered(type)?_cleanException(innerError.innererror.message):(innerError?"string"==typeof innerError?message.push(innerError):_pumpMessages(innerError):message.push(JSON.stringify(body,null,2)),_cleanException(message.join("\n")))}}catch(e){error.response||(error=$.D.propDeep(error,"data")||$.D.propDeep(error,"xhr"),error=error[0]||error)}var response=$.D.propDeep(error,"response");if(!response&&error.hasOwnProperty("readyState")&&error.hasOwnProperty("status")&&error.hasOwnProperty("statusText")&&error.hasOwnProperty("responseText")){var errorNew=JSON.stringify({url:error.url,statusText:error.statusText,responseText:error.responseText},null,2);return errorNew}if(error.message)return error.message;var body=response.body||$.D.propDeep(error,"message")||$.D.propDeep(error,"body"),isHtml=body.indexOf("<html")>=0;if(isHtml)message.push(body);else try{var err=(_parseJson(body)||{}).error;err?_pumpMessages(err):message.push(error.response.statusText)}catch(e){}}}return _cleanException(message.join("\n"))}catch(e){try{var message=ko.utils.stringifyJson(error);return _cleanException(message)}catch(e){return"Some kind of error just hapened to me.\nI am going to lay down for a while.\n"+e}}return ko.utils.stringifyJson(error.response).replace(/\\r\\n/g,"<br/>").replace(/\\\\r\\\\n/g,"<br/>").replace(/\\"/g,'"')},oDataErrorToString_:function(e){function r(e){return e.replace("\\r\\n","\n").replace(/",\s"/g,'",\n').replace(/An error occurred while processing this request./g,"").replace(/The transaction ended in the trigger. The batch has been aborted./g,"")}if("string"==typeof e)return e;var t=[e.response.requestUri];try{var n=$.parseJSON(e.response.body),a=(n.error||{}).innerError||n.error,o=$.Linq.last((((a||{}).innererror||{}).type||"").split("."));if(o&&$.D.serverExceptions.isRegistered(o))return r(a.innererror.message)}catch(i){e.response.statusCode>=400&&t.push(e.response.body)}try{var s=($.parseJSON(e.response.body)||{}).error;if(s){t.push(s.message.value);var u=s.innererror;if(u){t.push(u.message);for(var c=u.internalexception;c;c=c.internalexception)t.push(c.message)}}else t.push(e.response.statusText)}catch(i){}return r(t.join("\n"))},parseOdataBatchError:function(e,r){function t(e){var r=e["odata.error"];return r?[r.message.value,r.innererror.message,r.innererror.type]:[]}for(var n=0;n<e.__batchResponses.length;n++)for(var a=e.__batchResponses[n],o=0;o<a.__changeResponses.length;o++){var i=a.__changeResponses[o],s=parseInt(i.statusCode||(i.response||{}).statusCode);if(!isNaN(s)&&!(400>s)&&i.message){var u=ko.utils.parseJson(i.response.body),c=[];if("string"==typeof i.message&&c.push(i.message),u)if(u.error){c.push(u.error.message.value);var l=u.error.innererror}else c=c.concat(t(u));for(;l;)c.push(l.message),l=l.internalexception;return c}}},toODataDate:toAjaxDate,odataParam:function(e,r){return"undefined"==typeof e?e:null===e?"null":e.isGuid?parseGuid(e+""):"string"==typeof e?e.isGuid&&parseGuid(e)||"'"+escape(e)+"'":$.D.isDate(e)?odataFormatDate(e,r):e},odataParamsQuery:function(e){return $.each(e,function(r,t){"undefined"!=typeof t&&null!==t&&(e[r]=$.D.odataParam(t))}),$.map(e,function(e,r){return"undefined"!=typeof e&&null!==e?r+"="+escape(e):void 0})},odataFIlterQuery:function(e){return $.map(e,function(e,r){return"undefined"!=typeof e.value&&null!==e.value?e:void 0}).join(" and ")},inRange:function(e,r,t){return r>e?r:e>t?t:e},round:function(e,r){return r>=0?parseFloat(e.toFixed(r)):e},gradient:function(e,r,t,n,a,o,i){function s(e,r,t,n,a,o){for(var s=[e,r,t],u=[],c=0;o>=c;c++){var l=n+g*c,f=(l-n)/(a-n),d=[];$.each(s,function(e,r){var t=0==r[1]&&0==r[0]?0:f*(r[1]-r[0])+r[0];d.push(Math.round(t))}),u.push({value:$.D.round(l,i),rgb:d})}return u}var u=[e[0],e[1]],c=[r[0],r[1]],l=[t[0],t[1]],f=[u[1],e[2]],d=[c[1],r[2]],p=[l[1],t[2]],g=(a-n)/(o-1),h=n+(a-n)/2,m=s(u,c,l,n,h,o/2),y=s(f,d,p,h,a,o/2);return m.concat(y)},props:function(e){return $.each($.makeArray(arguments).slice(1),function(r,t){t=t.toLowerCase();for(var n in e)n.toLowerCase()==t&&(e=ko.utils.unwrapObservable(e[n]))}),e},prop:function(e,r){r=r.toLowerCase();for(var t in e)if(t.toLowerCase()==r)return e[t]},deepPath:function(e,r){for(var t=r.split("."),n=0;n<t.length;n++){if(!e.hasOwnProperty(t[n]))return;e=e[t[n]]}return e},propDeep:function(e,r,t){if(2==arguments.length&&(t=5),t-->=0&&"object"==typeof e&&!$.isEmptyObject(e)){r=r.toLowerCase();for(var n in e)if(n.toLowerCase()==r)return e[n];for(var n in e){var a=$.D.propDeep(e[n],r,t);if(void 0!==a)return a}}},sure:function(e,r,t){if(1==arguments.length)return e?function(){return 0==arguments.length?e:$.D.sure.apply(null,[e].concat(Array.prototype.slice.call(arguments,0)))}:null;if($.isPlainObject(r)){var n=r.error;r=r.name}var a=$.D.name(e,r,n);return!a&&n?n(e,r):2==arguments.length?e[a]:e[a]=t},name:sure_name,isDate:function(e){return"[object Date]"===Object.prototype.toString.call(e)},parseISO8601Date:function(e){var r=/(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d):(\d\d)(\.\d+)?(Z|([+-])(\d\d):(\d\d))/,t=[];if(t=e.match(r),!t)throw"Couldn't parse ISO 8601 date string '"+e+"'";var n=[1,2,3,4,5,6,10,11];for(var a in n)t[n[a]]=parseInt(t[n[a]],10);t[7]=parseFloat(t[7]);var o=Date.UTC(t[1],t[2]-1,t[3],t[4],t[5],t[6]);if(t[7]>0&&(o+=Math.round(1e3*t[7])),"Z"!=t[8]&&t[10]){var i=60*t[10]*60*1e3;t[11]&&(i+=60*t[11]*1e3),"-"==t[9]?o-=i:o+=i}return new Date(o)},jayData:{init:JayData_init,reRequire:function(e,r){function t(e,r){$.D.jayData.makeRequired(e,r,!0),e.addEventListener("beforeCreate",function(t,n,a){$.D.jayData.makeRequired(e,r,!1)}),e.addEventListener("afterCreate",function(t,n,a){$.D.jayData.makeRequired(e,r,!0)})}$.isArray(r)||(r=[r]),$.each(r,function(r,n){t(e,n)})},memberDefinition:JayData$memberDefinition,required:function(e,r,t){return JayData$memberDefinition(e,r,"required",t)},computed:function(e,r,t){return JayData$memberDefinition(e,r,"computed",t)},makeRequired:function(e,r,t){return arguments.length>1&&r?(e instanceof $data.Queryable&&(e=e.defaultType),r=e.field?e.field(r):e.elementType.field(r)):r=e,arguments.length<3?r.memberDefinition.required:(r.memberDefinition.required=void 0===t||t,r)},makeComputed:function(e,r,t){return arguments.length>1&&r?(e instanceof $data.Queryable&&(e=e.defaultType),r=e.field?e.field(r):e.elementType.field(r)):r=e,arguments.length<3?r.memberDefinition.required:(r.memberDefinition.computed=void 0===t||t,r)},kendo:{lookUp:{map:JayData$lookUpMap,fetch:JayData$fetchLookUp}}}};$.extend(!0,$.D,D);var kendo=new function(){this.filter=function(e,r,t){return{field:e,operator:r,value:t}},this.charts={font:function(e,r){return(r?"bold":"")+" "+(e||12)+"px  Arial,Helvetica,sans-serif"},series:function(e,r,t){return $.extend(!0,{type:e,data:r},t)},categories:function(e,r,t){return $.extend(!0,{baseUnit:e,categories:r},t)},title:function(e,r){return $.extend(!0,{text:e,padding:0,margin:0,font:"bold 12px Arial",position:"top"},r)}},this.templates={rightAlignedField:function(e,r,t){return $.extend(!0,{field:e,template:$.D.kendo.templates.rightAligned(e,r)},t)},rightAligned:function(e,r){return'<div style="text-align:right">#=kendo.toString('+e+",'"+r+"')#</div>"}},this.foreignFieldFactory=function(e,r,t){function n(e,r,t,n,a){return function(o,i){$('<select data-role="dropdownlist" style="margin:0px;width:100%" data-bind="value:'+e+'">').appendTo(o).kendoDropDownList({change:a||function(e,r,t){this._data()[this.selectedIndex]},autobind:!1,dataValueField:t,dataTextField:n,dataSource:r})}}return{field:e(),editor:n(e(),r,"value","text"),template:t}},this.getGridState=function(e){return{columns:e.columns.filter(function(e){return!e.command}),sort:e.dataSource.sort(),filter:e.dataSource.filter()}},this.syncGridColumnsUI=function(e,r){var t=$.Linq.toDictionary(e,"field");r.columns.forEach(function(e,n){var a=t[e.field];a&&a.hidden?r.hideColumn(n):r.showColumn(n)})},this.shiftIdColumns=function(e,r){function t(e){return/ID$/.test(e.field)}function n(e){return!t(e)}var a=e.filter(n);return r?a:a.concat(e.filter(t))}};$.extend(!0,$.D,{kendo:{}}),$.extend(!0,$.D.kendo,kendo)}"function"==typeof define&&define.amd?define(["ko","jquery","underscore","jquery-ui","jquery.extentions.Linq","jquery.extentions.fn","JSON.prune","kendo"],function(e,r){factory(e||require("knockout"),r,_)}):factory(ko,$,_)}();